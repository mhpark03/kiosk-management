commands:
  01_install_ffmpeg:
    command: |
      # Check if FFmpeg is already installed
      if ! command -v ffmpeg &> /dev/null; then
        echo "Installing FFmpeg..."

        # Create directory for FFmpeg
        mkdir -p /opt/ffmpeg
        cd /opt/ffmpeg

        # Download static FFmpeg build
        wget -q https://johnvansickle.com/ffmpeg/releases/ffmpeg-release-amd64-static.tar.xz

        # Extract
        tar -xf ffmpeg-release-amd64-static.tar.xz --strip-components=1

        # Create symlinks
        ln -sf /opt/ffmpeg/ffmpeg /usr/local/bin/ffmpeg
        ln -sf /opt/ffmpeg/ffprobe /usr/local/bin/ffprobe

        # Verify installation
        /usr/local/bin/ffmpeg -version
        /usr/local/bin/ffprobe -version

        echo "FFmpeg installation completed"
      else
        echo "FFmpeg is already installed at $(which ffmpeg)"
        ffmpeg -version
      fi
    ignoreErrors: false
